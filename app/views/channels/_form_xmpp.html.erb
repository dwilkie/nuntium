<%= form_for channel.becomes(Channel), :url => (channel.new_record? ? channels_path : channel_path(channel)) do |f| -%>
  <%= f.error_messages -%>
  <%= f.hidden_field :kind, :value => channel.kind %>
  <%= f.hidden_field :direction, :value => Channel::Bidirectional -%>
  <%= render 'edit_name', :f => f -%>
  <%= render 'edit_protocol', :f => f, :default => 'xmpp' -%>
  <%= render 'edit_priority', :f => f -%>
  <%= render 'edit_application', :f => f -%>
  <%= f.fields_for :configuration do |c| -%>
    <p>
    <%= c.label :user -%><br/>
    <%= c.text_field :user, :value => channel.configuration[:user] -%>
    </p>
    <p>
    <%= c.label :domain -%><br/>
    <%= c.text_field :domain, :value => channel.configuration[:domain] -%>
    </p>
    <p>
    <%= c.label :password -%><br/>
    <%= c.password_field :password, :value => channel.configuration[:password] -%>
    </p>
    <p>
    <%= c.label :server -%><br/>
    <%= c.text_field :server, :value => channel.configuration[:server] -%>
    </p>
    <p>
    <%= c.label :port -%><br/>
    <%= c.text_field :port, :value => channel.configuration[:port] || 5222 -%>
    </p>
    <p>
    <%= c.label :resource -%><br/>
    <%= c.text_field :resource, :value => channel.configuration[:resource] -%>
    </p>
    <p>
    <%= c.label :status -%><br/>
    <%= c.text_field :status, :value => channel.configuration[:status] -%>
    </p>
  <%- end -%>
  <%= render 'edit_costs', :f => f -%>
  <%= render 'shared/edit_custom_attributes', :f => f, :entity => channel, :as_restriction => true -%>
  <%= render 'edit_ao_rules', :f => f -%>
  <%= render 'edit_at_rules', :f => f -%>
  <%= f.submit -%>
<%- end -%>
