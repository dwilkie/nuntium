<h4>Create new <%= @kind == 'ao' ? 'Application Originated' : 'Application Terminated' %> Message</h4>

<% form_for :message, :url => { :controller => 'message', :action => (@kind == 'ao' ? :create_ao_message : :create_at_message)} do |f| %>
  <% [:from, :to, :subject].each do |field| %>
    <p>
    <%= f.label field %><br/>
    <%= f.text_field field, :style => 'width:250px' %>
    </p>
  <% end %>
  <p>
  <%= f.label :body %><br/>
  <%= f.text_area :body, :rows => 5, :cols => 50 %>
  </p>
  <% if @kind == 'ao' %>
    <p>
    <%= f.label :application %><br/>
    <%= f.select :application_id, @account.applications.map{|x| [x.name, x.id]} %>
    </p>
  <% else %>
    <p>
    <%= f.label :channel %><br/>
    <%= f.select :channel_id, @account.channels.map{|x| [x.name, x.id]} %>
    </p>
  <% end %>
  <%= render :partial => 'shared/edit_custom_attributes', :locals => {:f => f, :entity => @message, :include_channels => @kind == 'ao'} %>
  <%= submit_tag 'Create Message' %>
<% end %>

<%= link_to 'Go back', :controller => :home, :action => :home %>
